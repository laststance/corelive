# Corelive - PRD

## 1. 機能仕様

### 1.1 コア機能

**Option/Alt + hで表示されるフローティングバーでTODO表示とTODO追加が完了する事**

#### タスク管理機能

- **タスク作成**
  - グローバルショートカットから起動するElectronアプリのフローティングバーから追加
  - Electron、Web、Mobileアプリから作成
  - Chrome Extensionからの「Read it Later」タスク追加
  - **Chrome ExtensionからのTODOに対する関連リンク追加（新規追加）**
  - 休憩タスクの自動生成（25分作業後）(設定からON/OFF、時間の変更可能)
- **タスク属性**
  - タイトル（最大100文字）
  - 説明（Markdown対応、最大5000文字）
  - 予想所要時間（5分単位）
  - 実際の所要時間（自動計測）
  - カテゴリ（BigEpic紐付け）
  - 優先度（1-5段階）
  - タグ（最大10個）
  - URL（Read it Laterタスク用）
  - **関連リンク（新規追加）**
    - URL（必須）
    - タイトル（自動取得/編集可能）
    - メモ（任意、最大500文字）
    - 追加日時（自動記録）
    - リンクタイプ（参考資料/解決策/関連記事など）

- **タスクステータス**
  - 未着手（Backlog）
  - 進行中（In Progress）
  - 完了（Completed）
  - スキップ（Skipped）
  - 延期（Postponed）

#### Chrome Extension機能（拡張）

- **Read it Later機能**
  - 現在のページを新規タスクとして保存
  - タイトル自動取得
  - BigEpic選択
  - メモ追加

- **関連リンク追加機能（新規追加）**

  ```typescript
  interface RelatedLinkAddition {
    mode: 'new_task' | 'add_to_current'
    currentTask?: {
      id: string
      title: string
      status: 'In Progress'
    }
    linkData: {
      url: string
      title: string
      favicon: string
      excerpt?: string // ページから抽出した概要
      selectedText?: string // ユーザーが選択したテキスト
    }
    metadata: {
      type: 'reference' | 'solution' | 'related' | 'tool' | 'documentation'
      memo: string
      tags: string[]
      importance: 'high' | 'medium' | 'low'
    }
  }
  ```

- **自動検出機能（新規追加）**
  - 現在進行中のタスクのキーワードを含むページを検出
  - 関連性スコアの計算（0-100）
  - 関連性が高い場合（70以上）は自動提案

#### 自動タスク生成機能

- **ログインボーナスタスク**
  - タイトル：「作業体制に入る」
  - 一日の最初の起動時に自動生成・即完了
  - 通常タスクと同様にGitHub草UIに反映
  - タスク履歴に記録（フィルタリング可能）
- **休憩タスク**
  - 25分作業後に自動提案
  - 5分または15分の休憩を選択可能
  - スキップ可能（ただし連続スキップ時は警告）

- **合法休養タスク（新規追加）**
  - 連続作業日数に応じて自動付与
  - 7日連続: 「半日休養」タスク（4時間分の価値）
  - 14日連続: 「完全休養日」タスク（8時間分の価値）
  - 30日連続: 「リフレッシュ休暇」タスク（24時間分の価値）
  - 休養タスク完了時: 通常の3倍XP獲得
  - 未使用の休養タスクは累積可能（最大5つまで）

#### テキストエディタ自動TODO抽出機能（詳細追加）

- **リアルタイム抽出エンジン**

  ```typescript
  interface AutoTodoExtraction {
    patterns: {
      explicit: RegExp[] // "TODO:", "タスク:", "- [ ]" など
      implicit: RegExp[] // "〜する", "〜したい", "〜必要" など
      contextual: string[] // 文脈から判断する動詞パターン
    }

    extractionMode: 'aggressive' | 'balanced' | 'conservative'
    debounceTime: number // デフォルト: 2000ms
    minConfidence: number // 0.0 - 1.0 (デフォルト: 0.7)
  }
  ```

- **抽出プロセス**
  1. 入力テキストを2秒間隔でスキャン
  2. パターンマッチングとNLP解析を組み合わせ
  3. 信頼度スコアを計算（0.7以上で自動抽出）
  4. サイドバーの「未確定タスク」エリアに表示
  5. ワンクリックで正式タスクに変換

- **インテリジェント解析**
  - 時間表現の自動認識（「明日までに」→ デッドライン設定）
  - 人名・プロジェクト名の自動タグ付け
  - 優先度キーワードの認識（「緊急」「重要」など）
  - BigEpicとの自動紐付け（文脈解析）

#### ナビゲーション機能

- **次のタスク表示**
  - 画面上の固定位置に常時表示
  - カスタマイズ可能な表示位置（9箇所から選択）
  - 透明度調整（10-100%）
  - フォントサイズ調整（12-24px）
  - 色テーマ選択
  - **看板表示モード（新規追加）**
    - 現在着手中のタスク: 通常表示（100%不透明度）
    - その他のタスク: 薄く表示（30-50%不透明度）
    - On/Off切り替え可能

- **コンテキスト表示（新規追加）**
  - 個別タスクレベル: 「PRD詳細仕様作成」
  - プロジェクトレベル: 「クライアントA案件進行中」
  - BigEpicレベル: 「AWSからGCPへの移行作業」
  - 表示階層の切り替え: Cmd/Ctrl + Shift + N

- **タスク切り替え**
  - ワンクリックで次のタスクへ
  - ショートカット: Cmd/Ctrl + →
  - スワイプジェスチャー（モバイル）

#### ゲーミフィケーション機能

- **経験値システム**
  - タスク完了: 10-50XP（難易度による）
  - 連続達成ボーナス: +10XP/日
  - 寄り道カット: 20XP
  - 休憩タスク完了: 15XP
  - **ログインボーナス（作業開始）: 30XP**
  - **合法休養タスク完了: 通常の3倍XP**
  - **関連リンク追加: 5XP（新規追加）**
  - **表示/非表示切り替えオプション（新規追加）**

- **経験値システム表示設定（新規追加）**

  ```typescript
  interface GamificationSettings {
    showExperience: boolean // XPバー表示
    showLevel: boolean // レベル表示
    showAchievements: boolean // アチーブメント表示
    showAnimations: boolean // 完了時アニメーション
    showSounds: boolean // サウンドエフェクト
    minimalMode: boolean // プロフェッショナルモード
  }
  ```

- **レベルシステム**
  - Lv1-100（非線形成長カーブ）
  - レベルアップ時の特別エフェクト
  - マイルストーン報酬（新テーマ解放など）

- **達成記録**
  - GitHub草UIでの可視化
  - 日/週/月/年単位の統計
  - 連続記録（ストリーク）表示

### 1.2 拡張機能

#### AI機能

- **自動タスク抽出**
  - テキストからのTODO自動認識
  - 優先度の自動判定
  - 所要時間の推定
  - **関連リンクの要約生成（新規追加）**

- **振り返りサマリー**
  - 日次レポート生成
  - 週次/月次/年次サマリー
  - 改善提案の生成
  - **参照した関連リンクの活用度分析（新規追加）**

#### BigEpic管理

- **目標設定**
  - 年間目標の設定（最大5個）
  - 四半期マイルストーン
  - 進捗の可視化

- **タスク紐付け**
  - BigEpicへのタスク割り当て
  - 貢献度の計算
  - 達成率の表示

#### Lazy Tasking機能（新規追加）

- **後付けタスク登録**
  - 実行済みタスクの後からの登録
  - ショートカット: Cmd/Ctrl + Shift + T
  - 即座に「完了」ステータスで登録
- **クイック入力UI**

  ```typescript
  interface LazyTaskEntry {
    title: string
    completedAt: Date // デフォルト: 現在時刻
    duration: number // 推定作業時間
    bigEpic?: string
    tags?: string[]
    autoReward: boolean // XP自動付与
  }
  ```

- **時系列調整**
  - 完了時刻の手動調整可能
  - タイムラインビューでドラッグ＆ドロップ
  - 過去7日間まで遡及可能

- **達成感演出**
  - 通常タスク完了と同じ演出
  - 「忘れていたタスクも記録しました！」メッセージ
  - +5 XPボーナス（記録忘れ防止奨励）

#### 月次達成セレブレーション機能（新規追加）

- **トリガー条件**
  - 新しい月の初回アプリ起動時
  - 前月のタスク完了数が1つ以上

- **表示内容**

  ```typescript
  interface MonthlyAchievement {
    month: string // "2025年7月"
    totalTasks: number // 完了タスク総数
    totalXP: number // 獲得XP総数
    totalWorkHours: number // 総作業時間
    longestStreak: number // 最長連続日数
    bigEpicProgress: {
      // BigEpic別進捗
      name: string
      progress: number // パーセンテージ
    }[]
    topAchievements: Achievement[] // 主要な達成事項（最大3つ）
    monthlyRank: string // "S" | "A" | "B" | "C"
  }
  ```

- **UI/UXデザイン**
  - **全画面オーバーレイアニメーション**
    - 背景: ダークグラデーション with blur効果
    - カード: Vercel Ship風の高級感のあるデザイン
    - サイズ: 600x800px（デスクトップ）、90vw x 80vh（モバイル）
  - **アニメーションシーケンス**
    ```typescript
    const celebrationSequence = {
      0: 'フェードイン開始',
      200: 'カード3D回転登場',
      500: '数値カウントアップ開始',
      1500: 'パーティクルエフェクト',
      2000: '共有ボタン表示',
      5000: '自動フェードアウト（スキップ可能）',
    }
    ```

- **達成カードデザイン**

  ```
  ┌────────────────────────────────────┐
  │         ✨ MONTHLY REPORT ✨        │
  │              2025年7月              │
  │                                    │
  │    ┌──────────────────────────┐    │
  │    │      [3Dグラフィック]      │    │
  │    │    タスク完了数: 156       │    │
  │    └──────────────────────────┘    │
  │                                    │
  │  🏆 獲得XP: 4,580                  │
  │  ⏱️ 作業時間: 124時間30分           │
  │  🔥 最長ストリーク: 14日            │
  │                                    │
  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━    │
  │                                    │
  │  BigEpic進捗:                      │
  │  • プロダクト開発     ████░ 85%    │
  │  • スキルアップ       ██░░░ 45%    │
  │  • 健康管理          ███░░ 62%    │
  │                                    │
  │  月間ランク: A                     │
  │                                    │
  │  [共有] [詳細を見る] [閉じる]      │
  └────────────────────────────────────┘
  ```

- **サウンドデザイン**

  ```typescript
  const monthlyAchievementSounds = {
    entrance: 'epic-reveal.mp3', // 壮大な登場音
    counting: 'number-tick.mp3', // 数値カウント音
    rankReveal: 'rank-fanfare.mp3', // ランク表示音
    background: 'ambient-celebration.mp3', // BGM
  }
  ```

- **共有機能**
  - **共有画像生成**
    - Next.js OG Image APIで動的生成
    - サイズ: 1200x630px（OGP標準）
    - デザイン: 達成カードのミニマル版
  - **共有先対応**
    ```typescript
    interface ShareTargets {
      twitter: {
        text: `${month}は${totalTasks}個のタスクを完了！🎉 #TaskNav #月次達成`
        url: string
        hashtags: ['TaskNav', '生産性', 'タスク管理']
      }
      instagram: {
        storyImage: string // 1080x1920px
        caption: string
      }
      bluesky: {
        text: string
        embed: {
          uri: string
          title: string
          description: string
          thumb: string
        }
      }
    }
    ```

- **データ保存**
  ```typescript
  interface MonthlyAchievementRecord {
    id: string
    userId: string
    month: string
    data: MonthlyAchievement
    viewedAt: Date
    sharedAt?: Date
    shareCount: number
  }
  ```

#### 公開ダッシュボード機能（新規追加）

- **機能概要**
  - 有料プラン（Pro Plan）限定機能
  - 個人の達成状況を公開プロフィールとして共有可能
  - プライバシー保護を最優先とした設計

- **公開URL**
  - パターン: `https://tasknav.app/@{username}`
  - カスタムスラッグ設定可能（Pro機能）
  - QRコード生成機能

- **表示可能コンテンツ**

  ```typescript
  interface PublicDashboardContent {
    // 基本情報
    username: string
    displayName?: string
    bio?: string
    avatar?: string
    joinedDate: Date

    // 統計情報（すべて公開/非公開選択可能）
    stats: {
      totalTasks?: number
      totalXP?: number
      currentLevel?: number
      currentStreak?: number
      longestStreak?: number
      totalWorkHours?: number
    }

    // GitHub草UI（公開/非公開選択可能）
    contributionGraph?: {
      data: DailyContribution[]
      yearRange: string[]
      colorScheme: string
    }

    // 月次/年次サマリー（公開/非公開選択可能）
    achievements?: {
      monthly: MonthlyAchievement[]
      yearly: YearlyAchievement[]
    }

    // BigEpic進捗（公開/非公開選択可能）
    bigEpics?: {
      name: string
      progress: number
      isPublic: boolean
    }[]

    // バッジ・称号（公開/非公開選択可能）
    badges?: {
      id: string
      name: string
      icon: string
      earnedAt: Date
    }[]
  }
  ```

- **プライバシー設定**

  ```typescript
  interface PrivacySettings {
    // マスターコントロール
    isDashboardPublic: boolean

    // 個別コントロール
    visibility: {
      stats: VisibilityLevel
      contributionGraph: VisibilityLevel
      achievements: VisibilityLevel
      bigEpics: VisibilityLevel
      badges: VisibilityLevel
      taskDetails: 'never' // タスク詳細は常に非公開
    }

    // 詳細設定
    hideWeekends: boolean
    hideInactiveDays: boolean
    blurValues: boolean // 具体的な数値をぼかす

    // アクセス制限
    allowedViewers: 'everyone' | 'link_only' | 'selected_users'
    blockedUsers: string[]
  }

  type VisibilityLevel = 'public' | 'private' | 'friends_only'
  ```

- **SEO最適化**
  - **メタデータ**
    ```typescript
    export async function generateMetadata({ params }) {
      const user = await getUser(params.username)
      return {
        title: `${user.displayName} - TaskNav Profile`,
        description: `${user.bio || 'TaskNavでの達成記録'}`,
        openGraph: {
          images: [`/api/og/profile/${params.username}`],
        },
      }
    }
    ```
  - **パフォーマンス**
    - ISR（Incremental Static Regeneration）: 60秒
    - Edge Caching
    - 画像最適化（WebP、AVIF）

- **アナリティクス**
  ```typescript
  interface DashboardAnalytics {
    views: number
    uniqueVisitors: number
    shareCount: number
    clickThroughRate: number
    topReferrers: string[]
    deviceBreakdown: {
      mobile: number
      desktop: number
      tablet: number
    }
  }
  ```

## 2. 画面設計

### 2.1 メイン画面（デスクトップ）

```
┌─────────────────────────────────────────────────────────┐
│ [Logo] TaskNav          [Search] [Settings] [Profile]    │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────┐  ┌─────────────────────────────────────┐ │
│  │ サイドバー │  │        テキストエディタエリア         │ │
│  │          │  │                                     │ │
│  │ ▼ Today  │  │  # 今日のタスク                    │ │
│  │   ・Task1 │  │                                     │ │
│  │   ・Task2 │  │  - [ ] PRDの詳細仕様を作成する      │ │
│  │          │  │  - [ ] UIモックアップを作成する      │ │
│  │ ▼ 未確定 │  │  - [x] 競合調査を完了する           │ │
│  │   ・買い物 │  │                                     │ │
│  │   ・メール │  │  ## メモ                           │ │
│  │          │  │  明日のミーティングで確認すること：   │ │
│  │ ▼ BigEpic│  │  - インフラ構成の最終確認           │ │
│  │   ・Epic1 │  │  - リリーススケジュール             │ │
│  │   ・Epic2 │  │                                     │ │
│  │          │  │  ※ ↑自動的にタスクとして認識されます │ │
│  │ ▼ Tags   │  │                                     │ │
│  │   #work  │  │  ## 関連リンク                     │ │
│  │   #personal│ │  📎 [React最新ドキュメント] (参考資料)│ │
│  └──────────┘  │  📎 [インフラ構成図] (解決策)       │ │
│                └─────────────────────────────────────┘ │
│                                                          │
│  ┌─────────────────────────────────────────────────────┐│
│  │              GitHub草UI（達成記録）                   ││
│  │  [緑の濃淡で表示される365日分のグリッド]              ││
│  └─────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

### 2.2 タスク詳細画面（拡張）

```
┌─────────────────────────────────────────────────────────┐
│                  タスク詳細                              │
├─────────────────────────────────────────────────────────┤
│  タイトル: PRDの詳細仕様を作成する                       │
│  ステータス: 進行中 🔄                                   │
│  予想時間: 2時間 | 経過時間: 45分                       │
│                                                          │
│  ## 説明                                                 │
│  ゲーミフィケーション要素とUI仕様を含む                  │
│  詳細なPRDを作成する                                     │
│                                                          │
│  ## 関連リンク (3)                                       │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 📎 React最新ドキュメント                          │  │
│  │    タイプ: 参考資料 | 追加: 2時間前              │  │
│  │    メモ: Hooks APIの部分を特に参照               │  │
│  │    [開く] [編集] [削除]                         │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 📎 競合サービスUIパターン集                      │  │
│  │    タイプ: 参考資料 | 追加: 昨日                 │  │
│  │    メモ: ナビゲーションUIの参考に               │  │
│  │    [開く] [編集] [削除]                         │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 📎 インフラコスト計算ツール                      │  │
│  │    タイプ: ツール | 追加: 3日前                  │  │
│  │    メモ: Vercelの料金計算に使用                  │  │
│  │    [開く] [編集] [削除]                         │  │
│  └─────────────────────────────────────────────────┘  │
│                                                          │
│  [+ リンク追加] [タスク編集] [完了]                     │
└─────────────────────────────────────────────────────────┘
```

### 2.3 カレンダーUI振り返り画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│                    振り返りビュー                        │
├─────────────────────────────────────────────────────────┤
│  ┌───────────────┐  ┌─────────────────────────────────┐│
│  │   2025年7月    │  │        AI振り返りサマリー        ││
│  │ 日 月 火 水 木 金 土│  │                                ││
│  │     1  2  3  4  5│  │  7月14日の振り返り              ││
│  │  6  7  8  9 10 11│  │  ━━━━━━━━━━━━━━━━━━━━━━━━    ││
│  │ 13 [14] 15 16 17│  │                                ││
│  │ 20 21 22 23 24 25│  │  🎯 完了タスク: 12個            ││
│  │ 27 28 29 30 31   │  │  ⏱️ 作業時間: 6時間25分          ││
│  │                  │  │  🏆 獲得XP: 450                 ││
│  ├───────────────┤  │  📎 参照リンク: 8個              ││
│  │ [日] [週] [月] [年]│  │                                ││
│  └───────────────┘  │  ## 主な成果                    ││
│                      │  - PRD詳細仕様を完成させました   ││
│                      │  - UIモックアップ3案を作成        ││
│                      │  - 競合分析レポートを提出         ││
│                      │                                ││
│                      │  ## AI分析                      ││
│                      │  午前中の生産性が特に高く、      ││
│                      │  複雑なタスクを効率的に          ││
│                      │  処理できています。              ││
│                      │                                ││
│                      │  ## 有用だった関連リンク         ││
│                      │  1. React Hooks ドキュメント     ││
│                      │  2. インフラコスト計算ツール      ││
│                      │                                ││
│                      │  [📊 詳細統計] [📥 エクスポート]  ││
│                      └─────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

### 2.4 ノードグラフビュー（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│                 タスク達成ノードグラフ                   │
├─────────────────────────────────────────────────────────┤
│                                                          │
│     BigEpic: プロダクト開発                              │
│         ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━● 75%          │
│        /│\                            /│\              │
│       / │ \                          / │ \             │
│    ●    ●   ●                     ●    ●   ●          │
│   PRD  UI  競合分析            テスト 実装  デプロイ     │
│   100% 80%  100%               20%   60%   0%          │
│    │    │    │                  │     │    │          │
│    ●    ●    ●                  ●     ●    ○          │
│  詳細  Mock  レポート          単体   API   -          │
│   📎5   📎3   📎8              📎1   📎2              │
│                                                         │
│  [ズーム: 50%] [フィルタ: 今月] [表示: BigEpic別]      │
│                                                         │
│  凡例: ● 完了  ◐ 進行中  ○ 未着手                     │
│        線の太さ = タスクの重要度                        │
│        📎 = 関連リンク数                               │
└─────────────────────────────────────────────────────────┘
```

### 2.5 オンボーディング画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│                  TaskNavへようこそ！ (1/5)               │
├─────────────────────────────────────────────────────────┤
│                                                          │
│              🎮 ゲーム感覚のタスク管理                   │
│                                                          │
│    TaskNavは「次の目的」を常に表示することで、           │
│    ゲームのようなナビゲーション体験を提供します          │
│                                                          │
│                    [画面デモ表示]                        │
│         ┌─────────────────────┐                       │
│         │ 次: PRD詳細仕様作成  │ ← いつでも表示         │
│         │ 予想: 25分          │                        │
│         └─────────────────────┘                       │
│                                                          │
│                                        [次へ →]          │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│                  必須ショートカット (3/5)               │
├─────────────────────────────────────────────────────────┤
│                                                          │
│           ⌨️ これだけは覚えてください！                   │
│                                                          │
│   Cmd/Ctrl + N : ナビゲーター表示/非表示 🎯             │
│   Cmd/Ctrl + → : 次のタスクへ ➡️                       │
│   Cmd/Ctrl + T : 新規タスク作成 ✨                     │
│   Cmd/Ctrl + L : 関連リンク追加 📎                     │
│                                                          │
│   💡 ヒント: ナビゲーターが邪魔な時は                   │
│      Cmd+N で瞬時に隠せます！                          │
│                                                          │
│                [練習する] [スキップ] [次へ →]           │
└─────────────────────────────────────────────────────────┘
```

### 2.6 フローティングナビゲーター（拡張）

```
┌─────────────────────┐
│ 次: PRD詳細仕様作成  │
│ 予想: 25分          │
│ 📎 関連リンク: 3    │
│ [開始] [スキップ]   │
└─────────────────────┘
```

**表示モード**：

- コンパクトモード（タイトルのみ）
- 標準モード（タイトル＋時間）
- 詳細モード（タイトル＋時間＋説明＋関連リンク数）
- **コンテキストモード（新規追加）**

#### コンテキスト表示モード（新規追加）

```
┌──────────────────────────┐
│ 📂 クライアントA案件      │ ← BigEpic/プロジェクト
│ ├─ PRD詳細仕様作成 (今)  │ ← 現在のタスク（強調表示）
│ ├─ UIモックアップ作成     │ ← 次のタスク（薄く表示）
│ └─ テスト仕様書作成       │ ← その先のタスク（薄く表示）
│                          │
│ 進捗: ████░░░░░ 45%      │
│ [フォーカス] [詳細]      │
└──────────────────────────┘
```

#### 看板表示モード（新規追加）

```typescript
interface KanbanDisplayMode {
  enabled: boolean;
  currentTaskOpacity: 100;      // 現在のタスク: 100%
  upcomingTaskOpacity: 40;      // 次のタスク: 40%
  futureTaskOpacity: 20;        // それ以降: 20%

  // 表示するタスク数
  visibleTaskCount: 3 | 5 | 7;

  // アニメーション設定
  transitionDuration: 300;      // ms
  fadeInOut: boolean;

  // 自動切り替え
  autoAdvance: boolean;
  autoAdvanceDelay: 25 * 60;   // 25分（ポモドーロ）
}
```

#### 階層表示設定（新規追加）

```typescript
interface HierarchyDisplay {
  level: 'task' | 'project' | 'bigepic'
  showContext: boolean

  // プロジェクトレベル表示例
  projectView: {
    title: string // "AWSからGCPへの移行"
    currentPhase: string // "インフラ設計フェーズ"
    tasksInPhase: number // 12
    completedInPhase: number // 5
    estimatedHours: number // 40
  }

  // BigEpicレベル表示例
  bigEpicView: {
    title: string // "プロダクト開発 2025 Q1"
    projects: string[] // ["クライアントA", "社内ツール", ...]
    overallProgress: number // 65%
    deadline?: Date
  }
}
```

### 2.7 メニューバーアプリ（macOS）

```
┌──────────────────┐
│ 📝 PRD詳細仕様... │
│ ⏱️ 25分          │
│ 📎 関連リンク: 3  │
│ ──────────────── │
│ ▶️ タスク開始     │
│ ⏭️ 次のタスクへ   │
│ ✅ 完了          │
│ 📎 リンク追加     │
│ ──────────────── │
│ 🎯 今日: 5/8完了 │
│ 🔥 7日連続達成中  │
└──────────────────┘
```

### 2.8 Chrome Extension（拡張）

```
┌────────────────────────────────┐
│ TaskNav - Chrome Extension     │
├────────────────────────────────┤
│                                │
│ 現在のページをどうしますか？    │
│                                │
│ ┌────────────────────────────┐ │
│ │ 🎯 現在のタスクに追加        │ │
│ │                            │ │
│ │ タスク: PRD詳細仕様作成     │ │
│ │ 関連リンク数: 3 → 4         │ │
│ │                            │ │
│ │ [このオプションを選択]       │ │
│ └────────────────────────────┘ │
│                                │
│ ┌────────────────────────────┐ │
│ │ 📌 新規タスクとして保存      │ │
│ │                            │ │
│ │ Read it Laterタスクを作成   │ │
│ │                            │ │
│ │ [このオプションを選択]       │ │
│ └────────────────────────────┘ │
│                                │
│ 関連性スコア: 85% 🔥           │
│ （タスクとの関連性が高いです）  │
└────────────────────────────────┘
```

#### 関連リンク追加フォーム（Chrome Extension）

```
┌────────────────────────────────┐
│ 現在のタスクに追加             │
├────────────────────────────────┤
│ URL:                           │
│ [自動取得済み]                 │
│                                │
│ タイトル:                      │
│ [React Hooks ドキュメント]     │
│                                │
│ リンクタイプ:                  │
│ [▼ 参考資料        ]          │
│  ・参考資料                    │
│  ・解決策                      │
│  ・関連記事                    │
│  ・ツール                      │
│  ・ドキュメント                │
│                                │
│ メモ（任意）:                  │
│ [useEffectの使い方を_____]     │
│ [確認するため__________]       │
│                                │
│ 重要度:                        │
│ ◉ 高 ○ 中 ○ 低               │
│                                │
│ 選択したテキスト:              │
│ "useEffect accepts a function" │
│                                │
│ [キャンセル] [追加 (+5 XP)]    │
└────────────────────────────────┘
```

### 2.9 モバイル画面（React Native）

#### ホーム画面（拡張）

```
┌─────────────────┐
│ 📱 Status Bar   │
├─────────────────┤
│                 │
│  今日のタスク    │
│  ━━━━━━━━━━    │
│                 │
│ □ Task 1        │
│   📎 2          │
│ □ Task 2        │
│   📎 0          │
│ ✓ Task 3        │
│   📎 5          │
│ □ Task 4        │
│   📎 1          │
│                 │
│ [+] 新規タスク   │
│                 │
├─────────────────┤
│ 📊 統計 | 📝 作成│
└─────────────────┘
```

### 2.10 月次達成画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│                                                          │
│                    [暗転フェードイン]                     │
│                                                          │
│     ┌────────────────────────────────────────────┐      │
│     │                                            │      │
│     │          ✨ MONTHLY ACHIEVEMENT ✨          │      │
│     │                2025年7月                    │      │
│     │                                            │      │
│     │    ┌────────────────────────────────┐     │      │
│     │    │                                │     │      │
│     │    │     [3Dアニメーショングラフ]     │     │      │
│     │    │                                │     │      │
│     │    └────────────────────────────────┘     │      │
│     │                                            │      │
│     │         完了タスク: 156 🎯                 │      │
│     │         獲得XP: 4,580 ⚡                  │      │
│     │         作業時間: 124時間30分 ⏱️           │      │
│     │         最長ストリーク: 14日 🔥            │      │
│     │                                            │      │
│     │    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━    │      │
│     │                                            │      │
│     │         BigEpic達成度                      │      │
│     │                                            │      │
│     │    プロダクト開発  ████████░░ 85%         │      │
│     │    スキルアップ    ████░░░░░░ 45%         │      │
│     │    健康管理       ██████░░░░ 62%         │      │
│     │                                            │      │
│     │         月間ランク: A 🏆                   │      │
│     │                                            │      │
│     │    ────────────────────────────────      │      │
│     │                                            │      │
│     │    [📤 共有する] [📊 詳細] [✕ 閉じる]    │      │
│     │                                            │      │
│     └────────────────────────────────────────────┘      │
│                                                          │
│              [パーティクルエフェクト表示]                 │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 2.11 公開ダッシュボード画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│  https://tasknav.app/@username                          │
├─────────────────────────────────────────────────────────┤
│                                                          │
│     ┌─────────────────────────────────────────────┐     │
│     │          @username's TaskNav Profile         │     │
│     │                                             │     │
│     │  ┌─────────┐  ━━━━━━━━━━━━━━━━━━━━━━━━   │     │
│     │  │ Avatar  │   山田太郎                     │     │
│     │  │  Image  │   タスク管理で人生を変える      │     │
│     │  └─────────┘   Since: 2025年1月            │     │
│     │                                             │     │
│     └─────────────────────────────────────────────┘     │
│                                                          │
│  ┌─────────────────────────────────────────────────────┐│
│  │                  📊 統計情報                         ││
│  │                                                      ││
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐      ││
│  │  │   1,542    │  │  45,820   │  │    Lv.42   │      ││
│  │  │ 完了タスク  │  │  獲得XP    │  │   レベル    │      ││
│  │  └───────────┘  └───────────┘  └───────────┘      ││
│  │                                                      ││
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐      ││
│  │  │    28日    │  │   142日    │  │ 3,245時間  │      ││
│  │  │現在ストリーク│  │最長ストリーク│  │ 総作業時間  │      ││
│  │  └───────────┘  └───────────┘  └───────────┘      ││
│  └─────────────────────────────────────────────────────┘│
│                                                          │
│  ┌─────────────────────────────────────────────────────┐│
│  │               🌱 GitHub草UI（2025年）                 ││
│  │                                                      ││
│  │  [緑の濃淡で表示される365日分のコントリビューション]   ││
│  │                                                      ││
│  │  凡例: □ 0 ■ 1-5 ■ 6-10 ■ 11-15 ■ 16+             ││
│  └─────────────────────────────────────────────────────┘│
│                                                          │
│  ┌─────────────────────────────────────────────────────┐│
│  │                 🎯 BigEpic進捗                        ││
│  │                                                      ││
│  │  プロダクト開発    ████████████░░░░ 75%             ││
│  │  スキル向上       ██████░░░░░░░░░░ 40%             ││
│  │  健康管理         ████████░░░░░░░░ 55%             ││
│  │                                                      ││
│  └─────────────────────────────────────────────────────┘│
│                                                          │
│  ┌─────────────────────────────────────────────────────┐│
│  │                  🏆 獲得バッジ                        ││
│  │                                                      ││
│  │  🔥 炎の継続者   🌟 月間MVP    🚀 スピードスター      ││
│  │  💎 1000タスク   🌈 BigEpic達成  🎯 精密射手         ││
│  │                                                      ││
│  └─────────────────────────────────────────────────────┘│
│                                                          │
│              [🔗 プロフィールをシェア]                    │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 2.12 公開ダッシュボード設定画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│              公開ダッシュボード設定                      │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  公開URL設定                                             │
│  ┌─────────────────────────────────────────────────┐   │
│  │ https://tasknav.app/@[username_____]            │   │
│  │                                                  │   │
│  │ ⚠️ 一度設定したユーザー名は変更できません          │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  マスター設定                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 🔒 ダッシュボードを公開する         [ON] OFF     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  公開範囲設定                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 基本情報（名前、Bio）              ◉ 公開       │   │
│  │                                   ○ 非公開     │   │
│  │                                                  │   │
│  │ 統計情報                          ◉ 公開       │   │
│  │ └ 具体的な数値を表示              ◉ はい       │   │
│  │                                   ○ いいえ     │   │
│  │                                                  │   │
│  │ GitHub草UI                        ◉ 公開       │   │
│  │ └ 週末を非表示                    ◉ いいえ     │   │
│  │                                   ○ はい       │   │
│  │                                                  │   │
│  │ BigEpic進捗                       ○ 公開       │   │
│  │                                   ◉ 非公開     │   │
│  │                                                  │   │
│  │ 獲得バッジ                        ◉ 公開       │   │
│  │                                   ○ 非公開     │   │
│  │                                                  │   │
│  │ 月次/年次達成                     ○ 公開       │   │
│  │                                   ◉ 非公開     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  アクセス制限                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 閲覧可能な人:                                     │   │
│  │ ◉ 全員                                           │   │
│  │ ○ リンクを知っている人のみ                        │   │
│  │ ○ 選択したユーザーのみ                           │   │
│  │                                                  │   │
│  │ ブロックリスト: [ユーザー追加...]                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  プレビュー                                              │
│  ┌─────────────────────────────────────────────────┐   │
│  │ [公開ダッシュボードのプレビュー表示]              │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│                    [キャンセル] [設定を保存]              │
└─────────────────────────────────────────────────────────┘
```

### 2.13 Lazy Tasking画面（新規追加）

#### クイック入力モーダル

```
┌─────────────────────────────────────────────────────────┐
│              💭 タスクを後から記録                       │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  何をしましたか？                                        │
│  ┌─────────────────────────────────────────────────┐   │
│  │ メールの返信対応                                  │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  いつ完了しましたか？                                    │
│  [10分前 ▼] [15分前] [30分前] [1時間前] [カスタム...]   │
│                                                          │
│  どのくらい時間がかかりましたか？                        │
│  [5分] [10分] [15分] [25分] [30分] [45分] [1時間]       │
│                                                          │
│  カテゴリー（任意）                                      │
│  [▼ BigEpicを選択...]                                  │
│                                                          │
│  タグ（任意）                                            │
│  [#仕事] [#メール] [+ タグ追加]                         │
│                                                          │
│  ✨ このタスクを記録すると +15 XP 獲得！                 │
│                                                          │
│                    [キャンセル] [記録する 🎉]            │
└─────────────────────────────────────────────────────────┘
```

#### タイムライン調整ビュー

```
┌─────────────────────────────────────────────────────────┐
│                  📅 今日のタイムライン                   │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  9:00 ─┬─ ログインボーナス ✓                           │
│        │                                                │
│  9:30 ─┼─ PRD作成開始 ✓                                │
│        │                                                │
│ 10:00 ─┼─ [空き時間]                                   │
│        │   ↓ ここにドラッグ＆ドロップ                  │
│ 10:30 ─┼─ UI設計 ✓                                     │
│        │                                                │
│ 11:00 ─┼─ 📧 メール返信（後から追加） ← ドラッグ可能   │
│        │                                                │
│ 11:30 ─┼─ ミーティング ✓                               │
│        │                                                │
│                                                          │
│  [+ 忘れたタスクを追加]                                  │
└─────────────────────────────────────────────────────────┘
```

#### Lazy Taskingショートカットバー（常時表示オプション）

```
┌──────────────────────────────┐
│ 💭 今終わったタスクを記録... │
└──────────────────────────────┘
```

ホットキー: Cmd/Ctrl + Shift + T で即座に開く

### 2.14 テーマ設定画面（新規追加）

```
┌─────────────────────────────────────────────────────────┐
│                   🎨 テーマ設定                          │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  現在のテーマ: Tokyo Night                               │
│                                                          │
│  ┌─────────────────────────────────────────────────┐   │
│  │              プレビューエリア                      │   │
│  │  [実際のUIがリアルタイムプレビュー表示]            │   │
│  └─────────────────────────────────────────────────┘   │
│                                                          │
│  カテゴリー選択                                          │
│  [ダーク] [ライト] [グラデーション] [レトロ] [季節]      │
│                                                          │
│  ダークテーマ (30種)                                     │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐               │
│  │    │ │    │ │    │ │    │ │    │               │
│  │ 🌙 │ │ 🌊 │ │ 💜 │ │ ⚫ │ │ 🌃 │               │
│  │    │ │    │ │    │ │    │ │    │               │
│  └────┘ └────┘ └────┘ └────┘ └────┘               │
│  Midnight  Deep   Shadow  Carbon  Tokyo               │
│   Blue    Ocean  Purple   Black   Night               │
│                                                          │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐               │
│  │    │ │    │ │    │ │    │ │ More│               │
│  │ 🧛 │ │ 🎭 │ │ 🌌 │ │ 🦇 │ │ ... │               │
│  │    │ │    │ │    │ │    │ │     │               │
│  └────┘ └────┘ └────┘ └────┘ └────┘               │
│  Dracula  Nord   Space   Batman   +20                 │
│           Dark   Gray                                 │
│                                                          │
│  お気に入り ⭐                                           │
│  [Tokyo Night] [Synthwave] [Ocean Wave]                 │
│                                                          │
│  カスタムテーマ作成 (Pro) 🎨                            │
│  [+ 新規作成]                                           │
│                                                          │
│  テーマ同期設定                                          │
│  ☑️ すべてのデバイスで同期                              │
│  ☑️ 時間帯で自動切り替え（日中:ライト/夜:ダーク）      │
│                                                          │
│                        [キャンセル] [適用]               │
└─────────────────────────────────────────────────────────┘
```

### テーマプレビューカード詳細

```
┌────────────────────┐
│  🌃 Tokyo Night     │
│                    │
│  [プレビュー画像]   │
│  ████████████      │
│  ████████████      │
│  ████████████      │
│                    │
│  作者: TaskNav Team │
│  人気: ⭐⭐⭐⭐⭐   │
│  使用者: 1,234人    │
│                    │
│  [プレビュー] [選択]│
└────────────────────┘
```

## 3. UIコンポーネント仕様

### 3.1 カラーパレット

#### ベーステーマ（無料）

```css
--primary: #6366f1; /* Indigo */
--secondary: #8b5cf6; /* Purple */
--success: #10b981; /* Green */
--warning: #f59e0b; /* Amber */
--danger: #ef4444; /* Red */
--background: #0f0f0f; /* Dark */
--surface: #1a1a1a; /* Dark Gray */
--text-primary: #ffffff; /* White */
--text-secondary: #a3a3a3; /* Gray */
--link-accent: #3b82f6; /* Blue - 関連リンク用（新規追加） */
```

#### プレミアムカラーテーマ（100種類以上）（新規追加）

```typescript
interface ColorThemeCategories {
  // ダークテーマ（30種）
  dark: {
    'Midnight Blue': ColorTheme
    'Deep Ocean': ColorTheme
    'Shadow Purple': ColorTheme
    'Carbon Black': ColorTheme
    'Tokyo Night': ColorTheme
    Dracula: ColorTheme
    'Nord Dark': ColorTheme
    // ... 他23種
  }

  // ライトテーマ（20種）
  light: {
    'Snow White': ColorTheme
    'Soft Cream': ColorTheme
    Paper: ColorTheme
    'GitHub Light': ColorTheme
    'Solarized Light': ColorTheme
    // ... 他15種
  }

  // グラデーションテーマ（20種）
  gradient: {
    'Sunset Glow': ColorTheme
    'Northern Lights': ColorTheme
    'Ocean Wave': ColorTheme
    'Forest Mist': ColorTheme
    'Neon Dreams': ColorTheme
    // ... 他15種
  }

  // レトロ/ヴィンテージ（15種）
  retro: {
    'Terminal Green': ColorTheme
    'Amber CRT': ColorTheme
    'Commodore 64': ColorTheme
    'Windows 95': ColorTheme
    Synthwave: ColorTheme
    // ... 他10種
  }

  // 季節テーマ（15種）
  seasonal: {
    'Spring Bloom': ColorTheme
    'Summer Beach': ColorTheme
    'Autumn Leaves': ColorTheme
    'Winter Snow': ColorTheme
    Sakura: ColorTheme
    // ... 他10種
  }
}
```

#### プレミアムテーマ（透明度活用）

```css
/* Glassmorphism Theme */
--glass-bg: rgba(255, 255, 255, 0.05);
--glass-border: rgba(255, 255, 255, 0.1);
--glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.37);
--backdrop-blur: blur(10px);

/* Aurora Theme */
--aurora-gradient: linear-gradient(
  to right,
  rgba(134, 239, 172, 0.3),
  rgba(59, 130, 246, 0.3),
  rgba(147, 51, 234, 0.3)
);

/* Monthly Achievement Theme（新規追加） */
--achievement-gradient: linear-gradient(
  135deg,
  rgba(99, 102, 241, 0.95),
  rgba(139, 92, 246, 0.95)
);
--achievement-glow: 0 0 80px rgba(139, 92, 246, 0.4);
--achievement-particle: rgba(255, 255, 255, 0.8);
```

### 3.2 アニメーション仕様

#### タスク完了エフェクト

```javascript
// Confetti設定
const confettiConfig = {
  particleCount: 100,
  spread: 70,
  origin: { y: 0.6 },
  colors: ['#6366f1', '#8b5cf6', '#10b981'],
  duration: 3000,
}

// ログインボーナス専用エフェクト
const loginBonusConfig = {
  particleCount: 150,
  spread: 90,
  origin: { y: 0.5 },
  colors: ['#fbbf24', '#f59e0b', '#f97316'], // ゴールド系
  duration: 4000,
  gravity: 0.8,
}

// 合法休養タスク完了エフェクト（新規追加）
const legalRestConfig = {
  particleCount: 200,
  spread: 120,
  origin: { y: 0.4 },
  colors: ['#34d399', '#10b981', '#059669'], // グリーン系
  duration: 5000,
  gravity: 0.5,
  scalar: 1.2,
}

// 関連リンク追加エフェクト（新規追加）
const linkAddedConfig = {
  particleCount: 50,
  spread: 40,
  origin: { y: 0.7 },
  colors: ['#3b82f6', '#60a5fa', '#93c5fd'], // ブルー系
  duration: 2000,
  gravity: 1.0,
}

// 月次達成エフェクト（新規追加）
const monthlyAchievementConfig = {
  particleCount: 300,
  spread: 180,
  origin: { x: 0.5, y: 0.5 },
  colors: ['#6366f1', '#8b5cf6', '#ec4899', '#f59e0b'],
  duration: 6000,
  gravity: 0.3,
  scalar: 1.5,
  ticks: 200,
}

// サウンドエフェクト
const sounds = {
  taskComplete: 'coin-collect.mp3',
  levelUp: 'fanfare.mp3',
  streakContinue: 'combo.mp3',
  loginBonus: 'morning-chime.mp3',
  legalRest: 'healing-bell.mp3',
  linkAdded: 'paper-attach.mp3',
  monthlyReveal: 'epic-reveal.mp3', // 新規追加
  monthlyCountUp: 'number-tick.mp3', // 新規追加
  monthlyRankReveal: 'rank-fanfare.mp3', // 新規追加
  monthlyBGM: 'ambient-celebration.mp3', // 新規追加
}
```

#### トランジション

```css
/* タスクカードのホバー */
.task-card {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.task-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

/* レベルアップアニメーション */
@keyframes levelUp {
  0% {
    transform: scale(0.8);
    opacity: 0;
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* 関連リンク追加アニメーション（新規追加） */
@keyframes linkAttach {
  0% {
    transform: scale(0) rotate(-180deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.1) rotate(10deg);
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

/* 月次達成カード登場アニメーション（新規追加） */
@keyframes monthlyCardReveal {
  0% {
    transform: rotateY(-90deg) scale(0.8);
    opacity: 0;
  }
  50% {
    transform: rotateY(-20deg) scale(1.05);
    opacity: 0.8;
  }
  100% {
    transform: rotateY(0deg) scale(1);
    opacity: 1;
  }
}

/* 数値カウントアップ（新規追加） */
@keyframes countUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

### 3.3 タイポグラフィ

```css
/* フォントファミリー */
--font-primary: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
--font-mono: 'JetBrains Mono', 'Courier New', monospace;
--font-display: 'Outfit', 'Inter', sans-serif; /* 月次達成用（新規追加） */

/* フォントサイズ */
--text-xs: 0.75rem; /* 12px */
--text-sm: 0.875rem; /* 14px */
--text-base: 1rem; /* 16px */
--text-lg: 1.125rem; /* 18px */
--text-xl: 1.25rem; /* 20px */
--text-2xl: 1.5rem; /* 24px */
--text-3xl: 1.875rem; /* 30px - 月次達成用（新規追加） */
--text-4xl: 2.25rem; /* 36px - 月次達成用（新規追加） */
```

## 4. インタラクション設計

### 4.1 キーボードショートカット

| アクション               | Windows/Linux        | macOS               |
| ------------------------ | -------------------- | ------------------- |
| 新規タスク               | Ctrl + T             | Cmd + T             |
| タスク完了               | Ctrl + Enter         | Cmd + Enter         |
| 次のタスク               | Ctrl + →             | Cmd + →             |
| 前のタスク               | Ctrl + ←             | Cmd + ←             |
| フォーカスモード         | Ctrl + F             | Cmd + F             |
| **ナビゲーター表示切替** | **Ctrl + N**         | **Cmd + N**         |
| 検索                     | Ctrl + K             | Cmd + K             |
| 振り返りビュー           | Ctrl + R             | Cmd + R             |
| **関連リンク追加**       | **Ctrl + L**         | **Cmd + L**         |
| **月次達成表示**         | **Ctrl + M**         | **Cmd + M**         |
| **ダッシュボード設定**   | **Ctrl + ,**         | **Cmd + ,**         |
| **Lazy Task記録**        | **Ctrl + Shift + T** | **Cmd + Shift + T** |
| **コンテキスト切替**     | **Ctrl + Shift + N** | **Cmd + Shift + N** |
| **看板モード切替**       | **Ctrl + Shift + K** | **Cmd + Shift + K** |
| **テーマ切替**           | **Ctrl + Shift + ,** | **Cmd + Shift + ,** |

### 4.2 ドラッグ&ドロップ

- タスクの順序変更
- BigEpicへのタスク割り当て
- タグの追加（タグエリアへドロップ）
- **未確定タスクから正式タスクへの変換（新規追加）**
- **関連リンクの並び替え（新規追加）**
- **関連リンクのタスク間移動（新規追加）**

### 4.3 コンテキストメニュー

タスクを右クリック時：

- 編集
- 複製
- 削除
- BigEpicに割り当て
- タグを追加
- 明日に延期
- アーカイブ
- **関連リンクを追加（新規追加）**
- **関連リンクを表示（新規追加）**
- **⚙️ Config（設定へジャンプ）（新規追加）**
  - タスク設定
  - 通知設定
  - ショートカット設定

関連リンクを右クリック時（新規追加）：

- リンクを開く
- 新しいタブで開く
- URLをコピー
- メモを編集
- タイプを変更
- 他のタスクに移動
- 削除
- **⚙️ Config（関連リンク設定へ）**

月次達成カードを右クリック時（新規追加）：

- 画像として保存
- Twitter/Xで共有
- Instagramストーリーで共有
- BlueSkyで共有
- URLをコピー
- 詳細統計を表示
- **⚙️ Config（月次達成設定へ）**

フローティングナビゲーターを右クリック時（新規追加）：

- 表示位置を変更
- サイズを調整
- 透明度を調整
- 看板モード切り替え
- コンテキストレベル切り替え
- **⚙️ Config（ナビゲーター設定へ）**

#### Config機能（設定ナビゲーション）（新規追加）

```typescript
interface ConfigNavigation {
  // コンテキストメニューから設定画面へのディープリンク
  navigateToSettings(section: SettingsSection): void {
    const settingsPath = {
      'task': '/settings#task-management',
      'navigation': '/settings#floating-navigator',
      'theme': '/settings#appearance',
      'gamification': '/settings#gamification',
      'links': '/settings#related-links',
      'monthly': '/settings#monthly-achievement',
      'notification': '/settings#notifications',
      'shortcuts': '/settings#keyboard-shortcuts',
      'privacy': '/settings#privacy',
    };

    // スムーススクロールでセクションまで移動
    router.push(settingsPath[section]);
    setTimeout(() => {
      const element = document.querySelector(`#${section}`);
      element?.scrollIntoView({ behavior: 'smooth', block: 'start' });

      // ハイライトアニメーション
      element?.classList.add('highlight-pulse');
    }, 100);
  }
}
```

## 5. レスポンシブ設計

### ブレークポイント

```css
/* Mobile First */
@media (min-width: 640px) {
  /* Tablet */
}
@media (min-width: 1024px) {
  /* Desktop */
}
@media (min-width: 1280px) {
  /* Wide */
}
```

### レイアウト適応

- **モバイル**: 単一カラム、下部ナビゲーション、関連リンクは折りたたみ表示
- **タブレット**: 2カラム、サイドバー折りたたみ可能
- **デスクトップ**: 3カラム、全機能表示

### 月次達成カードのレスポンシブ対応（新規追加）

- **モバイル**: 90vw × 80vh、垂直スクロール可能
- **タブレット**: 600px × 700px、中央配置
- **デスクトップ**: 600px × 800px、3D効果あり

## 6. アクセシビリティ

### WCAG 2.1 AA準拠

- コントラスト比: 最小4.5:1（通常テキスト）、3:1（大きいテキスト）
- キーボードナビゲーション完全対応
- スクリーンリーダー対応（ARIA属性）
- フォーカスインジケーター明確化
- アニメーション無効化オプション

### カラーブラインド対応

- 色だけに依存しない情報伝達
- パターンやアイコンの併用
- カラーブラインドシミュレーターでの検証

### 月次達成機能のアクセシビリティ（新規追加）

```typescript
interface AccessibilitySettings {
  // 月次達成表示
  skipMonthlyAnimation: boolean // アニメーションスキップ
  reduceParticleEffects: boolean // パーティクル削減
  simplifiedAchievementCard: boolean // シンプル表示モード

  // サウンド設定
  muteSounds: boolean
  soundVolume: number // 0-100

  // モーション設定
  prefersReducedMotion: boolean
  animationSpeed: 'normal' | 'slow' | 'instant'
}
```

## 7. パフォーマンス指標

### 目標値

- 初回ロード: < 3秒
- タスク切り替え: < 100ms
- 検索レスポンス: < 200ms
- アニメーション: 60fps維持
- **関連リンクプレビュー生成: < 500ms（新規追加）**
- **月次達成カード生成: < 1秒（新規追加）**
- **公開ダッシュボードロード: < 2秒（新規追加）**

### 最適化施策

- 遅延ロード（画像、重いコンポーネント）
- 仮想スクロール（大量タスクリスト）
- Service Workerでのキャッシュ
- WebPフォーマット使用
- **関連リンクのメタデータキャッシュ（新規追加）**
- **月次データの事前計算とキャッシュ（新規追加）**
- **公開ダッシュボードのISR（60秒）（新規追加）**

## 8. ログインボーナス実装詳細

### 8.1 判定ロジック

```typescript
interface LoginBonusLogic {
  // 一日の最初の判定
  isFirstLoginOfDay(): boolean {
    const lastActivity = user.lastActivityAt;
    const now = new Date();

    // 条件1: 日付が変わっている
    if (lastActivity.toDateString() !== now.toDateString()) {
      return true;
    }

    // 条件2: 4時間以上の非アクティブ後（昼休みなど）
    const hoursSinceLastActivity = (now - lastActivity) / (1000 * 60 * 60);
    if (hoursSinceLastActivity >= 4) {
      return true;
    }

    return false;
  }
}
```

### 8.2 タスク自動生成

```typescript
const loginBonusTask = {
  id: generateId(),
  title: '作業体制に入る',
  description: '今日も一日頑張りましょう！',
  type: 'SYSTEM_GENERATED',
  category: 'DAILY_ROUTINE',
  points: 30,
  status: 'COMPLETED',
  completedAt: new Date(),
  isLoginBonus: true,
  icon: '🌅',
}
```

### 8.3 連続ログインボーナス

| 連続日数 | 基本ポイント | ボーナス | 合計   |
| -------- | ------------ | -------- | ------ |
| 1-6日    | 30 XP        | 0 XP     | 30 XP  |
| 7日      | 30 XP        | +20 XP   | 50 XP  |
| 14日     | 30 XP        | +30 XP   | 60 XP  |
| 30日     | 30 XP        | +50 XP   | 80 XP  |
| 100日    | 30 XP        | +100 XP  | 130 XP |

### 8.4 時間帯別メッセージ

```typescript
const getGreetingMessage = (hour: number): string => {
  if (hour < 5) return '🌙 深夜の作業お疲れさまです'
  if (hour < 9) return '🌅 おはようございます！'
  if (hour < 12) return '☀️ 良い午前中を！'
  if (hour < 17) return '🌤️ 午後も頑張りましょう'
  if (hour < 21) return '🌆 お疲れさまです'
  return '🌛 遅くまでお疲れさまです'
}
```

### 8.5 設定オプション

```typescript
interface LoginBonusSettings {
  enabled: boolean // ログインボーナス有効/無効
  showAnimation: boolean // アニメーション表示
  playSound: boolean // サウンド再生
  autoCloseModal: boolean // モーダル自動クローズ
  autoCloseDelay: number // 自動クローズまでの秒数（3-10秒）
  customMessage: string // カスタムメッセージ（Pro機能）
}
```

## 9. オンボーディング設計（新規追加）

### 9.1 オンボーディングフロー

```typescript
interface OnboardingFlow {
  steps: OnboardingStep[]
  currentStep: number
  skippable: boolean
  completionReward: number // 50 XP
}

interface OnboardingStep {
  id: string
  title: string
  description: string
  interactive: boolean
  requiredAction?: string
  focusElement?: string
}
```

### 9.2 オンボーディングステップ

1. **ウェルカム**: TaskNavの基本コンセプト紹介
2. **ナビゲーター体験**: フローティングUIの操作
3. **必須ショートカット**: Cmd+N、Cmd+→、Cmd+T、Cmd+Lの練習
4. **テキストエディタ**: 自動TODO抽出のデモ
5. **ゲーミフィケーション**: XPとレベルシステムの説明
6. **カスタマイズ**: 表示位置と透明度の設定

### 9.3 インタラクティブチュートリアル

```typescript
const interactiveTutorial = {
  shortcutPractice: {
    target: 'Cmd+N',
    instruction: 'ナビゲーターを表示/非表示してみましょう',
    successCondition: 'navigator.toggled',
    reward: 10, // XP
  },
  firstTaskCreation: {
    target: 'editor',
    instruction: '"買い物に行く"と入力してみてください',
    successCondition: 'task.autoExtracted',
    reward: 20, // XP
  },
  firstLinkAddition: {
    target: 'Cmd+L',
    instruction: '関連リンクを追加してみましょう',
    successCondition: 'link.added',
    reward: 15, // XP
  },
}
```

## 10. 合法休養システム（新規追加）

### 10.1 休養タスク生成ルール

```typescript
interface LegalRestSystem {
  streakThresholds: {
    7: RestTask // 半日休養
    14: RestTask // 完全休養日
    30: RestTask // リフレッシュ休暇
  }

  maxAccumulated: 5
  expirationDays: 30
}

interface RestTask {
  type: 'HALF_DAY' | 'FULL_DAY' | 'REFRESH_VACATION'
  title: string
  description: string
  xpMultiplier: 3
  hoursEquivalent: number
  icon: string
}
```

### 10.2 休養タスクUI

```
┌────────────────────────────────┐
│      🌴 合法休養を獲得しました！     │
│                                    │
│    7日間連続で作業を続けたご褒美に   │
│      「半日休養」タスクを付与！      │
│                                    │
│    いつでも使用可能（30日間有効）    │
│                                    │
│         [後で確認] [今使う]         │
└────────────────────────────────┘
```

### 10.3 休養タスク管理

```typescript
const restTaskTemplates = {
  HALF_DAY: {
    title: '半日休養 🌤️',
    description: '4時間分の作業に相当する休養を取りましょう',
    xpReward: 150,
    icon: '🌤️',
  },
  FULL_DAY: {
    title: '完全休養日 🏖️',
    description: '今日は完全にオフ！8時間分の価値があります',
    xpReward: 300,
    icon: '🏖️',
  },
  REFRESH_VACATION: {
    title: 'リフレッシュ休暇 🌴',
    description: '24時間分の大型休暇です。しっかり休んでください！',
    xpReward: 600,
    icon: '🌴',
  },
}
```

## 11. 関連リンク機能詳細（新規追加）

### 11.1 関連性判定アルゴリズム

```typescript
interface RelevanceScoring {
  calculateScore(currentTask: Task, pageContent: PageContent): number {
    const scores = {
      titleMatch: this.calculateTitleMatch(currentTask.title, pageContent.title),
      contentMatch: this.calculateContentMatch(currentTask.description, pageContent.text),
      tagMatch: this.calculateTagMatch(currentTask.tags, pageContent.keywords),
      domainAuthority: this.getDomainScore(pageContent.domain)
    };

    return (
      scores.titleMatch * 0.3 +
      scores.contentMatch * 0.4 +
      scores.tagMatch * 0.2 +
      scores.domainAuthority * 0.1
    );
  }
}
```

### 11.2 関連リンクプレビュー生成

```typescript
interface LinkPreview {
  url: string
  title: string
  description: string
  thumbnail?: string
  favicon: string
  siteName: string
  publishedDate?: Date
  readingTime?: number // 推定読了時間（分）
}

// Open Graph / Twitter Cardメタデータ取得
async function generateLinkPreview(url: string): Promise<LinkPreview> {
  const metadata = await fetchMetadata(url)
  return {
    url,
    title: metadata.ogTitle || metadata.title,
    description: metadata.ogDescription || metadata.description,
    thumbnail: metadata.ogImage,
    favicon: metadata.favicon,
    siteName: metadata.ogSiteName,
    publishedDate: metadata.articlePublishedTime,
    readingTime: estimateReadingTime(metadata.contentLength),
  }
}
```

### 11.3 関連リンクAPIエンドポイント

```typescript
// 関連リンク追加
POST /api/tasks/{taskId}/links
{
  url: string;
  type: 'reference' | 'solution' | 'related' | 'tool' | 'documentation';
  memo?: string;
  importance: 'high' | 'medium' | 'low';
  selectedText?: string;
}

// 関連リンク一覧取得
GET /api/tasks/{taskId}/links

// 関連リンク更新
PUT /api/tasks/{taskId}/links/{linkId}

// 関連リンク削除
DELETE /api/tasks/{taskId}/links/{linkId}

// 関連性スコア計算
POST /api/tasks/{taskId}/links/calculate-relevance
{
  url: string;
}
```

### 11.4 Chrome Extension連携詳細

```javascript
// Chrome Extension Background Script
chrome.tabs.onUpdated.addListener(async (tabId, changeInfo, tab) => {
  if (changeInfo.status === 'complete') {
    const currentTask = await getCurrentTask()

    if (currentTask && currentTask.status === 'In Progress') {
      const relevanceScore = await calculateRelevance(
        currentTask,
        tab.url,
        tab.title,
      )

      if (relevanceScore >= 70) {
        chrome.action.setBadgeText({ text: '!', tabId })
        chrome.action.setBadgeBackgroundColor({ color: '#10b981', tabId })
      }
    }
  }
})

// Content Script
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  if (request.action === 'getSelectedText') {
    const selectedText = window.getSelection().toString()
    sendResponse({ selectedText })
  }
})
```

### 11.5 関連リンク分析レポート

```typescript
interface LinkAnalytics {
  totalLinksAdded: number
  linksByType: Record<LinkType, number>
  mostAccessedLinks: Array<{
    link: RelatedLink
    accessCount: number
  }>
  averageLinksPerTask: number
  linkUtilizationRate: number // クリック率
  topDomains: Array<{
    domain: string
    count: number
  }>
}

// 週次/月次レポートに含める
const generateLinkInsights = (analytics: LinkAnalytics): string => {
  return `
## 関連リンク活用状況
- 今週追加したリンク: ${analytics.totalLinksAdded}個
- 最も参照されたリンク: ${analytics.mostAccessedLinks[0].link.title}
- 平均リンク活用率: ${analytics.linkUtilizationRate}%

### 改善提案
${
  analytics.linkUtilizationRate < 50
    ? '追加したリンクの活用率が低いです。本当に必要なリンクのみを厳選しましょう。'
    : 'リンクを効果的に活用できています。この調子で継続しましょう。'
}
  `
}
```
